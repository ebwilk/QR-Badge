<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Ford Smart Badge - Fixed</title>
<style>
    /* --- CORE VARIABLES --- */
    :root {
        --ford-blue: #003478;
        --ford-light-blue: #eef4ff;
        --text-dark: #1a1a1a;
        --warning: #f57f20;
        --bg-gray: #f4f5f8;
    }

    body {
        font-family: "Ford Antenna", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        background: var(--bg-gray);
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
        margin: 0;
    }

    /* --- WIDGET CONTAINER (The Anchor) --- */
    /* IMPORTANT: position: relative is the key fix here */
    .smart-badge {
        position: relative; /* <--- THIS KEEPS THE POPUP INSIDE */
        background: white;
        width: 100%;
        max-width: 360px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        overflow: hidden; /* Ensures corners clip the content */
    }

    /* --- HEADER --- */
    .live-status-header {
        background: var(--ford-light-blue);
        padding: 15px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #dae7ff;
    }

    .status-label { font-size: 11px; font-weight: 700; color: var(--ford-blue); text-transform: uppercase; margin-bottom: 4px; display: block; }
    .time-display { font-size: 20px; font-weight: 800; color: var(--text-dark); }
    
    .status-icon { height: 32px; width: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: #e3f2fd; color: var(--ford-blue); }
    .status-icon.break { background: #fff3e0; color: var(--warning); animation: pulse 2s infinite; }

    /* --- BODY --- */
    .badge-content { padding: 20px; }
    
    .user-section { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; }
    .avatar { width: 50px; height: 50px; border-radius: 50%; background: #333; color: white; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 18px; }
    .user-info h2 { margin: 0; font-size: 16px; color: var(--text-dark); }
    .user-info p { margin: 2px 0 0 0; font-size: 12px; color: #666; }

    /* --- BUTTONS --- */
    .action-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .action-btn { border: 1px solid #eee; background: white; padding: 15px 10px; border-radius: 8px; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 8px; transition: background 0.2s; }
    .action-btn:hover { background: #f9f9f9; }
    .action-btn svg { width: 24px; height: 24px; fill: var(--ford-blue); }
    .action-label { font-size: 12px; font-weight: 600; color: #444; }

    /* --- THE FIX: QR OVERLAY --- */
    .qr-overlay {
        position: absolute; /* Stays inside .smart-badge because of relative parent */
        top: 0; left: 0; width: 100%; height: 100%; /* Covers card only */
        background: rgba(255,255,255,0.98);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 100; /* Stays on top of card content */
        
        /* Visibility Toggles */
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s;
    }
    
    .qr-overlay.active {
        opacity: 1;
        pointer-events: all;
    }

    /* Context Bar (Orange Alert) */
    .qr-context-bar {
        position: absolute; top: 0; left: 0; right: 0;
        background: var(--warning); color: white;
        padding: 10px; text-align: center; font-weight: 700; font-size: 13px;
        transform: translateY(-100%); transition: transform 0.3s;
    }
    .qr-context-bar.show { transform: translateY(0); }

    /* Simulator Controls */
    .sim-controls { margin-top: 20px; padding: 10px; background: #eee; border-radius: 8px; font-size: 12px; text-align: center; }
    .sim-btn { margin: 0 5px; padding: 5px 10px; cursor: pointer; background: #333; color: white; border: none; border-radius: 4px; }
    
    @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(245, 127, 32, 0.4); } 70% { box-shadow: 0 0 0 6px rgba(245, 127, 32, 0); } 100% { box-shadow: 0 0 0 0 rgba(245, 127, 32, 0); } }
</style>
</head>
<body>

<div class="smart-badge">
    
    <div class="live-status-header" id="header-bg">
        <div>
            <span class="status-label" id="status-label">Shift Progress</span>
            <div class="time-display" id="time-display">04h 15m</div>
        </div>
        <div class="status-icon" id="status-icon">
            <svg style="width:20px;height:20px;fill:currentColor" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm4.2 14.2L11 13V7h1.5v5.2l4.5 2.7-.8 1.3z"/></svg>
        </div>
    </div>

    <div class="badge-content">
        <div class="user-section">
            <div class="avatar">JD</div>
            <div class="user-info">
                <h2>John Doe</h2>
                <p>Zone C â€¢ Team 4</p>
            </div>
        </div>

        <div class="action-grid">
            <div class="action-btn" onclick="showQR('Time Clock')">
                <svg viewBox="0 0 24 24"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg>
                <span class="action-label">Time Clock</span>
            </div>
            <div class="action-btn" onclick="showQR('Lunch Pay')">
                <svg viewBox="0 0 24 24"><path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"/></svg>
                <span class="action-label">Lunch Pay</span>
            </div>
        </div>
    </div>

    <div class="qr-overlay" id="qr-layer" onclick="hideQR()">
        <div class="qr-context-bar" id="qr-alert">Break Ending in 14:22</div>
        
        <h3 id="qr-title" style="margin-bottom:15px; color:#333;">Scan Badge</h3>
        
        <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=FORD-ID-123" 
             style="width:160px; height:160px; border:4px solid #fff; box-shadow:0 4px 10px rgba(0,0,0,0.1);">
             
        <p style="color:#666; font-size:12px; margin-top:20px; font-weight:600;">Tap anywhere to close</p>
    </div>
</div>
<div class="sim-controls">
    <button class="sim-btn" onclick="setMode('shift')">Simulate: Working</button>
    <button class="sim-btn" onclick="setMode('break')">Simulate: On Break</button>
</div>

<script>
    let currentMode = 'shift'; 

    function setMode(mode) {
        currentMode = mode;
        const header = document.getElementById('header-bg');
        const label = document.getElementById('status-label');
        const time = document.getElementById('time-display');
        const icon = document.getElementById('status-icon');

        if(mode === 'shift') {
            label.innerText = "Shift Progress";
            time.innerText = "04h 15m";
            time.style.color = "#1a1a1a";
            icon.className = "status-icon";
            header.style.background = "#eef4ff"; 
        } else {
            label.innerText = "Break Remaining";
            time.innerText = "14:22";
            time.style.color = "#d32f2f";
            icon.className = "status-icon break";
            header.style.background = "#fff3e0"; 
        }
    }

    function showQR(title) {
        document.getElementById('qr-title').innerText = title;
        document.getElementById('qr-layer').classList.add('active');
        
        if(currentMode === 'break') {
            document.getElementById('qr-alert').classList.add('show');
        }
    }

    function hideQR() {
        document.getElementById('qr-layer').classList.remove('active');
        document.getElementById('qr-alert').classList.remove('show');
    }
</script>

</body>
</html>
